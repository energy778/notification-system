## Система оповещения о появлении абонента в сети (далее просто - система)

Данная система нужна для предоставления дополнительной услуги абонентам мобильных операторов.

Если абонент А звонит абоненту Б и абонента Б нет в сети сотового оператора (например, он заехал в туннель), то в систему приходит HTTP POST запрос на URL`unavailableSubscriber`, в теле которого передаётся JSON вида:

```json
{
  "msisdnA": "79031112233",
  "msisdnB": "79063331122"
}
```

где `msisdnA` - номер звонящего абонента (может как являться, так и не являтся абонентом оператора), `msisdnB` - номер вызываемого абонента (является абонентом оператора).

После получения данного события система должна слать во внешнюю систему запрос вида `http://external-url/ping?msisdn=<msisndB>`, где `external-url/ping` - url внешней системы (настраиваемый параметр), `msisdnB` - номер абонента оператора, который сейчас недоступен).

Если на пинг пришел ответ вида:

```json
{
  "status": "unavailableSubscriber"
}
```

то система повторяет запрос через N минут (N - настраиваемый параметр).

Если же в ответ вернулось:

```json
{
  "status": "inNetwork"
}
```

то система должна отправлять на `msisdnA`, (номер, который пришел в изначальном запросе) SMS посредством POST запроса на внешнюю систему `http://sms-service/sendSms`, где `sms-service/sendSms` - url системы SMS (настраиваемый параметр). Пример запроса:

```json
{
  "msisdnA": "79063332211",
  "msisdnB": "79031112233",
  "text": "Этот абонент снова в сети"
}
```

где `msisdnA` - номер абонента оператора, `msisndB` - номер, который звонил абоненту изначально, `text` - текст СМС, также в тексте можно задать ключ $time, который должен замениться на время появления абонента в сети (`абонент в сети с $time. Вы можете перезвонить ему`).

При этом текст СМС должен выбираться в зависимости от языка абонента и лежать в настройках. Язык (русский или английский) задан в профиле абонента и состоит из уникального номера телефона и временной зоны. Если профиля для данного абонента нет, то использовать язык и временную зону по умолчанию. Профили должны лежать в БД.

СМС можно отправлять абоненту только в дневное время с 09:00 до 22:00, при этом должна учитываться таймзона абонента (если в таймзоне абонента время находится за пределами интервала, СМС должна быть отправлена в следующее временное окно).

### Ограничения

- Количество абонентов - 10_000_000
- Количество входящих запросов на недоступность абонента - от 100 до 500 запросов в секунду
- Через систему отправки смс можно отправлять не более 300 смс в секунду
- Попытки пинга абонента должны осуществляться не более 3х суток
